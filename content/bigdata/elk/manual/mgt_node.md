---
title: "节点管理"
description: 本小节主要介绍如何管理 ELK 节点。 
keyword: ELK 在线伸缩,节点管理
weight: 15
collapsible: false
draft: false
---

本小节主要介绍如何管理集群节点，包括增加、删除、扩容节点。

## 前提条件

- 已获取 QingCloud 管理控制台登录账号和密码，且已获取集群操作权限。
- 已创建 ELK 集群，且集群状态为**活跃**。

## 增加节点

1. 录 QingCloud 管理控制台。
2. 选择**产品与服务** > **大数据服务** > **ELK 服务**，进入集群管理页面。
3. 选择目标集群，点击目标集群 ID，进入集群详情页面。
4. 在**节点**页签，点击**新增节点**，弹出节点配置窗口。
   
   ![增加节点](../../images/add_node.png)

5. 配置节点信息。
   
   可以增加 `Elasticsearch 节点`、`Elasticsearch 专有主节点`、`Kibana 节点` 或 `Logstash 节点` 的数量，可以对每个新增节点指定 IP 或选择自动分配。

6. 点击**提交**，返回节点列表页面。

   待集群状态切换为**活跃**，即节点添加完毕。

## 删除节点

删除节点过程中会锁定 ELK 集群，节点状态将切换为**更新中**，不支持集群其他生命周期操作。

删除节点前系统会自动将数据从待删除节点迁移到其他节点，迁移数据如果因各种原因失败，则不会删除节点。

> **说明：**
>
> 删除节点有丢失数据的风险，建议谨慎操作！`ELK 5.5.1 - QingCloud 1.2.2` 之前的版本需要人工确保数据是否已经安全转移到其他节点再删除，如操作不当会有数据丢失风险，升级到新版以后，系统会在删除节点前尝试把处于打开状态的 index 迁移到未删除节点，但处于关闭状态的 index 无法迁移，建议先打开这些 index 或者作好备份以后再进行节点删除，否则这些 index 可能会永久丢失。
>
> 对于通常规模的集群大概需要 1、2 分钟的时间恢复到 Green 状态，可通过访问任意 Elasticsearch 节点的 9200 端口来获得集群状态，示例命令为：
>
> ```bash
> curl $ES_IP:9200/_cluster/health
> ```
>
> 也可以通过浏览器访问Kibana节点的9100端口提供的 ES Head 界面或 Kibana 节点的 9800 端口提供的 ElasticHD 界面来查看集群状态。

1. 在**节点**页签，勾选目标节点。

   > **说明：**
   > 
   >如需要在 `ELK 5.5.1 - QingCloud 1.2.2` 之前的版本删除节点，注意一次只能删除一个，并且必须等到上个节点删除后且 Elasticsearch 集群完成数据迁移后状态变成 Green 才能删除下一个节点，否则数据可能会丢失。

2. 点击**删除**，弹出节点删除确认窗口。
   
3. 点击**确认**，返回节点列表页面。待集群状态切换为**活跃**，即节点删除完毕。


## 纵向伸缩

由于不同节点类型压力值不同，可对各种角色的节点进行纵向的扩容及缩容。

1. 在集群详情页面，点击**基本属性**模块下拉菜单栏。
2. 展开菜单栏，点击**扩容集群**，弹出扩容集群配置窗口。
3. 配置待扩容集群信息：勾选节点角色，配置节点 CPU、内存和磁盘大小。
   
    ![纵向伸缩](../../images/scale_up_down.png)
   
4. 点击**提交**，返回集群详情页面。待节点状态切换为**活跃**，即扩容完毕。
