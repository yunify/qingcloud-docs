---
title: "选择解析模式"
description: dns解析模式
date: 2021-04-28T00:38:25+09:00
weight: 5
draft: false
---

## 模式简介

QingCloud DNS 提供四种解析模式以应对不同业务场景的负载均衡需求，包括**普通模式**、**轮询模式**、**权重模式**和**智能模式**。

> 这四种模式将都会出现在 A 类型的解析记录上。
> 
> CNAME 类型由于其本身具备排他性，则只有**普通模式**和**权重模式**。

### 普通模式

同时配置多条记录值，每次查询时返回的解析顺序保持不变。

![普通模式配置](../_images/dns_simple_mode.png)

>
    第一次请求，返回 139.34.32.100 139.34.32.101 139.34.32.102
    第二次请求，返回 139.34.32.100 139.34.32.101 139.34.32.102
    ...
    每次请求的解析结果都不变。

**普通模式**解析效率比较高。适用于业务针对同一线路只有一个主要的解析地址，即无其他地址或其他地址只用来做灾备的场景。

### 轮询模式

同时配置多条记录值，每次查询时会根据上一次查询顺序重新排序后返回。

![轮询模式配置](../_images/dns_rr_mode.png)

>
    第一次请求， 返回 139.34.32.100 139.34.32.101 139.34.32.102  
    第二次请求， 返回 139.34.32.101 139.34.32.102 139.34.32.100
    第三次请求， 返回 139.34.32.102 139.34.32.100 139.34.32.101
    第四次请求， 返回 139.34.32.100 139.34.32.101 139.34.32.102

**轮询模式**解析结果较为均衡。适用于业务针对同一线路有多个主要的解析地址，且每个解析地址的承载量都差不多的场景。

### 智能模式

同时配置多条记录值，每次查询时会根据用户来源对记录值进行排序返回最优结果，可减少您对精细化线路配置的烦恼。

![智能模式](../_images/dns_geo_mode.png)

适用于业务较为庞大（用户覆盖面广、解析地址非常多、访问频次高），同一个域名的配置过于复杂的场景。

使用**智能模式**搭配较粗粒度的分线解析可获得最优配置。
>智能模式与解析线路配置不冲突，非默认线路的解析也可以使用智能模式。

### 权重模式

同时配置**多组**记录值和对应权重，每次查询时按权重比值返回其中的一组，可实现不同服务器集群业务承载量的任意比值分配。

![权重模式配置](../_images/dns_weight_mode.png)

>
    第一次请求， 返回 139.12.233.1 139.12.233.2
    第二次请求， 返回 139.12.233.3 139.12.233.4
    第三次请求， 返回 139.12.233.3 139.12.233.4
    第三次请求， 返回 139.12.233.1 139.12.233.2
    ...
    多次请求后，两组解析结果出现的比例满足权重值 50:50 ，即 1:1

**权重模式**旨在随心所欲的流量调度。适用于业务针对同一线路有多个解析地址，但不同的地址对应服务器的业务承载能力各有不同（例如服务器性能差距过大）的场景。

## 操作步骤

1. 登录 QingCloud 管理控制台。
2. 选择**产品与服务** > **网络服务** > **云解析 DNS**，进入域名管理列表页面。
3. 点击域名名称，进入域名解析记录页面。
4. 选择目标云服务器，展开解析配置详情。
5. 在**模式**列，即可选择四种模式。

## 模式切换

当您编辑解析记录时或针对已保存的解析记录，您都可以随意的切换解析模式。

### 普通、轮询、智能模式相互切换

普通模式、轮询模式和智能模式由于都是单组设计，可任意相互切换。

![启用单个 ip](../_images/click_common_mode.png)

### 从普通模式（或轮询、智能模式）切换到权重模式

权重模式是多组设计，针对已保存的其他模式解析记录切换到权重模式时，将弹出设置框。

![切换到权重模式](../_images/common_to_weight.png)

### 从权重模式切换到普通模式（或轮询、智能模式）

当多组设计的权重模式切换到其他模式时，则同云服务器同线路下其他所有权重记录将会与当前记录合并同时剔除重复数据。

![切换到权重模式](../_images/weight_common.png)
