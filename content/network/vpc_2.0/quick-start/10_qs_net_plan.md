---
title: "网络规划"
linkTitle: "网络规划"
date: 2021-05-18T10:08:56+09:00
description:
draft: false
weight: 10
---

为避免后续临时扩容带来的不便及问题，请您在创建青云 VPC 网络前，根据您的实际业务需求合理的规划 VPC 网络和私有网络（子网）的数量及网段等。

## 应该使用几个 VPC 网络？

- **一个 VPC 网络**

  如果您没有多地域部署系统的要求且各系统之间也不需要通过 VPC 网络进行隔离，那么推荐使用一个 VPC 网络。

- **多个 VPC 网络**

  如果您有以下任何一个需求，推荐您使用多个 VPC 网络：

  - 多地域部署系统

    VPC 网络是地域级别的资源，是不能跨地域部署的。当您有多地域部署系统的需求时，就必须使用多个 VPC 网络。您可以通过使用 VPN 服务、VPC 边界路由器或者 SDWAN 等产品实现 VPC 网络互通。

  - 多业务系统隔离

    如果在一个地域的多个业务系统需要通过 VPC 进行严格隔离，例如生产环境和测试环境，那么也需要使用多个 VPC。

## 应该使用几个私有网络？

使用多少个私有网络与系统规模及系统规划有关。一个 VPC 网络可以连接254个私有网络，每个私有网络最多可容纳252台云服务器。

- 若您只使用一个 VPC 网络，建议您至少使用两个私有网络，并且将两个私有网络分布在不同可用区，这样可以实现跨可用区容灾。

  > **说明**：
  >
  > 同一地域不同可用区之间的网络通信延迟很低，但也需经过业务系统的适配和验证。由于系统调用复杂、系统处理时间长、跨可用区调用等原因可能产生期望之外的网络延迟。建议您进行系统优化和适配，在高可用和低延迟之间找到平衡。

- 若前端系统可以被公网访问并且有主动访问公网的需求，考虑到容灾，可将不同的前端系统部署在不同的私有网络下，将后端系统部署在另外的私有网络。

## 应该选择什么网段？

在创建 VPC 网络及连接私有网络时，您需要以无类域间路由块（CIDR block）的形式为您的网络划分私网网段。

> **说明**：
>
>  VPC 及私有网络网段掩码一旦设定后，则无法修改。因此，请结合业务规模和通信场景合理地规划私有网络和子网，这将有利于后期业务的平滑扩展和运维。

- **规划 VPC 网段**

  VPC 网络支持192.168.0.0/16、172.16.0.0/16-172.31.0.0/16这些网段及其子网作为私网地址范围。

  - 如果云上只有一个 VPC 网络并且不需要和本地数据中心互通时，可以选择上述私网网段中的任何一个网段或其子网。

  - 如果您需要建立多个 VPC 网络，或者有 VPC 网络和本地数据中心构建混合云的需求，建议使用以上标准网段的子网作为 VPC 的网段，掩码建议不超过16位。

- **规划私有网络网段**

  私有网络的网段必须是其所属 VPC 网络网段的子集，且私有网络支持的子网掩码范围为16～29，可提供8~65536个地址。例如 VPC 的网段是192.168.0.0/16，则该 VPC 下的私有网络的网段可以是192.168.0.0/17～192.168.0.0/29。

  规划私有网络网段时，请注意：

  - 私有网络网段的确定需要考虑该私有网络私有网络下所能容纳云服务器实例数量。
  - 每个私有网络中的第一个和最后三个IP地址为系统保留地址。以192.168.1.0/24为例，192.168.1.0、 192.168.1.253、192.168.1.254和192.168.1.255这些地址是系统保留地址。

## VPC 网络间互通或 VPC 网络与本地数据中心互通有什么要求？

当您 VPC 网络间互通或 VPC 网络与本地数据中心互通的需求时，请确保 VPC 网络的网段与互通网段均不冲突。

在多 VPC 网络的情况下，建议遵循以下网段规划原则：

- 尽量做到不同 VPC 网络的网段不同，不同 VPC 网络可以使用标准网段的子网来增加 VPC 网络可用的网段数。

- 如果无法做到不同 VPC 网络的网段不同，则尽量保证不同 VPC 网络的私有网络网段不同。

- 如果也无法做到私有网络网段不同，则需要保证通信的私有网络网段不同。

