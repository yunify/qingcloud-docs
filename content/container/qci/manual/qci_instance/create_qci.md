---
title: "创建实例"
description: 介绍如何从 Docker Hub 拉取镜像部署容器实例。
keyword: QCI,弹性容器实例,创建QCI实例
draft: false
weight: 10
---

本文介绍根据业务需要创建一个 QCI 实例。

## 前提条件

- 已在合适的区域下创建 VPC 网络及私有网络。具体操作，请参见[创建 VPC 网络](/network/vpc/manual/vpcnet/10_create_vpc/)。
- 如果您需要从 Docker Hub 或其他外部镜像仓库拉取镜像，请确保 VPC 网络具备网络外网访问能力，否则镜像拉取将失败。您可以为 VPC 网络绑定公网 IP或绑定配置了 SNAT 的 NAT 网关。

## 操作步骤

1. 登录管理控制台，选择**产品与服务** > **容器服务** > **弹性容器实例(QCI)**，进入**弹性容器实例**页面。

2. 点击**创建**，进入弹性容器实例配置引导页面。

3. 配置容器镜像。

   <img src="../../../_images/config_image.png" style="zoom:50%;" />

   1. 点击**添加**，弹出**添加容器镜像**窗口。

      > **说明**
      >
      > 可添加多个容器镜像，创建多个容器。一个 QCI 实例支持最多 20 个容器。

   2. 配置容器镜像信息。

      | 参数名称     | 说明                                                         |
      | ------------ | ------------------------------------------------------------ |
      | 容器镜像     | 容器镜像拉取地址。<br/>由镜像所在仓库 URI 和镜像 Tag（可省略，缺省为 `latest`）唯一确认。对于公有镜像仓库（Docker Hub），可直接填写`镜像名称:Tag`。<br/>例如：公有仓库镜像 `nginx:latest`，私有仓库镜像 `dockerhub.qingcloud.com/my_namespace/myrepo:2.0` |
      | 仓库类型     | 选择镜像仓库类型：<br/>**- 公有仓库**：即 Docker Hub。<br/>**- 私有仓库**：可使用青云 Docker 镜像仓库、Harbor 镜像仓库或你自建私有 Registry。<br/>选择私有仓库，需要配置仓库访问凭证，包括仓库地址、用户名及密码。 |
      | 端口         | 指定容器需要暴露的协议（ TCP 或者 UDP ）和端口。             |
      | 高级参数     | 以下为高级参数配置。                                         |
      | 容器名称     | 容器名称。                                                   |
      | 容器类型     | **- 初始容器**：初始容器在工作容器之前启动，一般用来进行一些环境初始化的工作。<br/>**- 工作容器**：一般指用于运行业务的容器。<br/>初始容器串行按序执行，工作容器是常驻在容器组中的，并行执行。 |
      | 镜像拉取策略 | 容器镜像拉取策略，包括**尝试重新下载镜像**、**优先使用本地镜像**和**仅使用本地镜像**，使用方法与 k8s 类似。 |
      | CPU          | 为当前容器分配 CPU 资源。<div style="background-color: #D8ECDE; padding: 10px 24px; margin: 10px 0; border-left: 3px solid #00a971;"><b>说明</b><br/>每个 QCI 实例内支持最多 20 个容器，每个容器的资源支持自定义配置，但汇总到 QCI 实例级别需要满足 CPU 和内存约束。若自定义配置不满足约束条件，QCI 会进行自动规整，计费按照规整后 CPU 和内存值进行计费。</div> |
      | 内存         | 为当前容器分配内存资源。                                     |
      | 工作目录     | 指定容器工作目录。                                           |
      | 启动命令     | 启动命令列表。                                               |
      | 启动参数     | 启动参数列表。                                               |
      | 环境变量     | 容器环境变量列表。                                           |
      | 最大日志容量 | 单个容器保存的最大日志大小。超过指定阈值，系统会选择一个合适的时间截取日志。 |

   3. 点击**提交**，返回容器镜像配置页面。

   4. 选择云服务器类型。

   5. 点击**显示高级选项**，可设置高级参数。

      | 参数名称 | 说明                                                         |
      | -------- | ------------------------------------------------------------ |
      | 重启策略 | QCI 实例重启策略。 <br/>**- 总是重启(Always)**：实例中有容器处于非运行状态时重启实例。  <br/>**- 失败时重启(OnFailure)** ：实例中有容器异常退出时重启实例。  <br/>**- 从不重启(Never)** ：任何情况下不重启实例。<div style="background-color: #D8ECDE; padding: 10px 24px; margin: 10px 0; border-left: 3px solid #00a971;"><b>说明</b><br/>实例重启策略仅决定组内容器的逻辑行为，实例不会被自动重启。</div> |
      | 镜像缓存 | 是否使用镜像缓存。若使用，需要选择已创建的镜像缓存。         |
      | 共享内存 | 实例内容器之间共享内存的大小。单位 MB，默认关闭（不共享）。  <br/>申请的共享内存应小于实例实际申请的物理内存的 1/2 。 |

4. 点击**下一步**，进入**挂载存储卷**设置页面。

   如果您需要将数据持久化存储，可挂载云硬盘或通过配置文件声明。存储卷的生命周期独立于容器实例，每个实例中声明的存储卷由实例容器组中的所有容器共享。

   1. 点击**挂载**，弹出**挂载硬盘**窗口。

      支持两种方式挂载存储卷：**配置文件**及**已有硬盘**。

   2. 配置硬盘挂载信息，点击**提交**。

      选择以下其中一种方式进行配置：
      
      **- 配置文件**：提供向 QCI 注入配置数据的方法，并且只需以明文形式填入配置数据。
      
      **- 已有硬盘**：硬盘需提前创建，写入硬盘的数据可以在 QCI 销毁时依然保留，适用于 MySQL 、Redis 等场景。
      
      > **说明**
      >
      > 硬盘类型需要与 QCI 云服务器类型匹配，具体规则可以参考 [QCI 云服务器类型与硬盘类型匹配策略](/container/qci/faq/#qci-云服务器类型与硬盘类型的匹配策略) 。
      
      <!--<table>
        <thead><tr><td>挂载方式</td><td>参数名称</td><td>说明</td></tr></thead>
        <tr><td rowspan="4">配置文件</td><td>名称</td><td></td></tr>
         <tr><td>路径</td><td></td></tr>
         <tr><td>内容</td><td></td></tr>
         <tr><td>容器挂载</td><td></td></tr>
         <tr><td rowspan="3">已有硬盘</td><td>名称</td><td></td></tr>
         <tr><td>选择硬盘</td><td></td></tr>
         <tr><td>容器挂载</td><td></td></tr>
      </table>-->

5. 点击**下一步**，进入**网络设置**页面，设置网络参数。

   ![](../../../_images/set_qci_net.png)

   1. 选择已经创建好的 VPC 网络及私有网络。
   2. IP 可选`自动分配`或`手动指定`。

6. 点击**下一步**，进入**基本信息**设置页面。

   ![](../../../_images/set_qci_basicinfo.png)

   1. 输入实例名称及描述。

   2. 点击**添加**，可添加标签，自定义键和值。

      > **说明**
      >
      > 标签用于对资源对象的识别，便于外部工具进行查找。

7. 点击**创建**，返回**弹性容器实例**页面，等待实例创建成功。

   创建成功后，可以在列表中看到实例状态为`运行中`。

