---
title: "镜像漏洞扫描"
draft: false
enableToc: false
weight: 15
---

Harbor 默认通过开源项目 [Trivy](https://github.com/aquasecurity/trivy) （Harbor 2.0.0 及之后版本）或  [Clair](https://github.com/coreos/clair) （Habor v2.2.0 版本之后从默认中删除）提供镜像漏洞的静态分析 。

您可以对特定镜像或 Harbor 中的所有镜像手动启动扫描。您也可以设置策略，使系统定期自动扫描所有图像。

> **说明**：
>
> 本操作中截图以 Harbor v2.2.1 为例，仅供参考，请以您部署的 Harbor 实际版本为准。

## 启用默认扫描器

您可以在部署 [Harbor 镜像仓库](/container/harbor/quickstart/qs10_deploy_harbor/) 时启用 Trivy 或 Clair；若部署时未开启，也可以在 Harbor 集群页面[修改配置参数](/container/harbor/manual/man08_mdy_para/)进行启用。

以 Harbor 2.2.1 - QingCloud 1.6.0 版本为例，将**加载 trivy plugin** 修改为 **true**，如下所示：

<img src="/container/harbor/_images/man3015_enable_trivy.png" alt="enable_trivy" style="zoom:50%;" />

## 扫描特定镜像

1. 使用至少具有项目管理员权限的帐户登录 Harbor 界面。

2. 进入**项目**页面并选择一个项目。

3. 可选：点击**扫描器**页签，可查看到该项目的默认扫描器的详细信息。您可以点击选择扫描器，来选择您已创建的其他扫描器。

   ![select_sanner](/container/harbor/_images/man3015_select_sanner.png)

4. 点击**镜像仓库**页签，选择一个仓库源，进入该仓库的 **Artifacts** 页面。

5. 勾选一个或多个需要扫描的 **Artifacts** ，单击**扫描**。

   <img src="/container/harbor/_images/man3015_scan_some.png" alt="scan_some" style="zoom:50%;" />

## 扫描所有镜像

1. 使用具有 Harbor 系统管理员权限的帐户登录 Harbor 界面。

2. 选择**系统管理** > **审查服务**，点击**漏洞**页签。

   <img src="/container/harbor/_images/man3015_scan_all.png" alt="scan_all" style="zoom:50%;" />

3. 点击**开始扫描**便可立即扫描所有镜像。

## 设置自动扫描

1. 使用具有 Harbor 系统管理员权限的帐户登录 Harbor 界面。

2. 选择**系统管理** > **审查服务**，点击**漏洞**页签。

3. 点击**编辑**，设置扫描周期。

   <img src="/container/harbor/_images/man3015_preiod_scan.png" alt="preiod_scan" style="zoom:50%;" />

4. 单击**保存**。

